import React, { Component } from 'react'
import Paper from './Paper'

import './App.css'

import MR_BUBBLES from './mr-bubbles.jpg'

const INITIAL_DATA = {
  Path: [{
    id: 1,
    data: 'M177.02128,699.17021c14.25138,-14.25138 31.86427,-36.4945 40.85106,-54.46809c3.12112,-6.24223 0.90261,-39.93287 2.7234,-43.57447c6.67805,-13.3561 6.94469,-30.2298 13.61702,-43.57447c19.24589,-38.49177 46.93214,-79.61299 76.25532,-108.93617c0.9078,-0.9078 1.8156,-7.26241 2.7234,-8.17021c5.44352,-5.44352 15.59321,-15.59321 21.78723,-21.78723c0.9078,-0.9078 1.8156,-7.26241 2.7234,-8.17021c5.25033,-5.25033 19.26031,-8.36669 24.51064,-13.61702c8.71923,-8.71923 36.0829,-28.93507 49.02128,-35.40426c2.17872,-1.08936 5.99149,1.08936 8.17021,0c11.23195,-5.61598 18.72549,-18.89466 29.95745,-24.51064c5.37154,-2.68577 10.83304,-5.41652 16.34043,-8.17021c1.64432,-0.82216 6.91128,1.25893 8.17021,0c4.99894,-4.99894 14.04119,-9.744 21.78723,-13.61702c11.08241,-5.5412 24.60593,-21.83488 35.40426,-27.23404c1.65055,-0.82527 7.02899,-1.58218 8.17021,-2.7234c6.44051,-6.44051 19.68055,-22.09559 29.95745,-27.23404c2.47043,-1.23521 9.11605,-3.66924 10.89362,-5.44681c4.5806,-4.5806 9.0661,-15.42667 16.34043,-19.06383c13.35675,-6.67838 26.62094,-21.48068 38.12766,-27.23404c2.80818,-1.40409 20.90203,-7.28501 21.78723,-8.17021c21.266,-21.266 40.61421,-35.1674 59.91489,-54.46809c7.55898,-7.55898 22.41113,-30.26939 32.68085,-35.40426c14.6744,-7.3372 26.80547,-18.63526 38.12766,-29.95745c14.0874,-14.0874 26.92826,-23.89908 35.40426,-40.85106c1.86848,-3.73695 7.1589,-13.61702 10.89362,-13.61702',
  },{
    id: 2,
    data: 'M1481.53191,671.93617c0,-15.22643 -15.38771,-33.49883 -21.78723,-46.29787c-3.68828,-7.37656 -1.62558,-15.2426 -8.17021,-21.78723c-1.3617,-1.3617 1.3617,-6.80851 0,-8.17021c-3.18275,-3.18275 -10.17312,-7.44972 -13.61702,-10.89362c-3.61158,-3.61158 -5.90581,-11.81162 -8.17021,-16.34043c-3.4958,-6.9916 -12.27251,-14.99591 -16.34043,-19.06383c-1.28383,-1.28383 1.28383,-4.16298 0,-5.44681c-6.70708,-6.70708 -14.18438,-19.63118 -19.06383,-24.51064c-3.75349,-3.75349 -5.72983,-14.18307 -8.17021,-19.06383c-3.25972,-6.51943 -32.28249,-40.65189 -38.12766,-43.57447c-11.66067,-5.83034 -37.29955,3.67105 -46.29787,8.17021c-6.78981,3.3949 -17.81671,-0.62356 -24.51064,2.7234c-11.72649,5.86325 -60.70265,10.89362 -76.25532,10.89362c-7.92044,0 -25.75036,3.46524 -32.68085,0c-5.11088,-2.55544 -3.91631,-8.76667 -8.17021,-10.89362c-8.59932,-4.29966 -24.9638,-22.69355 -29.95745,-32.68085c-1.62244,-3.24488 -2.98742,-11.15763 -5.44681,-13.61702c-4.76092,-4.76092 -15.94967,-15.94967 -21.78723,-21.78723c-2.4151,-2.4151 -1.08214,-7.61108 -2.7234,-10.89362c-0.85319,-1.70638 -9.86975,-9.86975 -10.89362,-10.89362c-2.4277,-2.4277 -1.27724,-8.00129 -2.7234,-10.89362c-0.78331,-1.56662 -19.24945,-20.51834 -21.78723,-21.78723c-5.80993,-2.90496 -15.9773,2.90496 -21.78723,0c-9.44213,-4.72106 -60.26317,-5.27267 -70.80851,0c-2.85723,1.42862 -11.44331,-2.17372 -13.61702,0c-0.64191,0.64191 0.81196,2.31742 0,2.7234c-6.53617,3.26809 -17.97447,-3.26809 -24.51064,0c-4.90906,2.45453 -37.91212,5.55458 -43.57447,2.7234c-11.8988,-5.9494 -20.06284,-31.81866 -27.23404,-35.40426c-5.00704,-2.50352 -14.59806,-10.13229 -19.06383,-19.06383c-0.82527,-1.65055 -1.58218,-7.02899 -2.7234,-8.17021c-6.26156,-6.26156 -11.64263,-14.36604 -16.34043,-19.06383c-1.20622,-1.20622 -6.26576,-20.70173 -8.17021,-24.51064c-1.8156,-3.63121 1.8156,-9.98582 0,-13.61702c-4.40905,-8.8181 -16.34043,-71.21626 -16.34043,-81.70213c0,-15.83637 1.94661,-40.07426 10.89362,-49.02128c1.9013,-1.9013 -0.05808,-19.00575 5.44681,-24.51064c0.64191,-0.64191 0,-1.8156 0,-2.7234c0,-10.39875 3.95772,-21.53247 8.17021,-29.95745c0.81142,-1.62284 2.7234,-15.2005 2.7234,-8.17021',
  }],
  Circle: [{
    id: 3,
    data: 'M140.02128,693.7234c0,-20.43454 16.56546,-37 37,-37c20.43454,0 37,16.56546 37,37c0,20.43454 -16.56546,37 -37,37c-20.43454,0 -37,-16.56546 -37,-37z',
    fillColor: 'red',
  },{
    id: 4,
    data: 'M1440.3617,674.65957c0,-20.43454 16.56546,-37 37,-37c20.43454,0 37,16.56546 37,37c0,20.43454 -16.56546,37 -37,37c-20.43454,0 -37,-16.56546 -37,-37z',
    fillColor: 'red',
  }],
  Rectangle: [],
}

class App extends Component {

  constructor(props) {
    super(props)
    this.state = {
      mounted: false,
    }
    this._box = null
    this._request = null
  }

  resizeWindow = () => {
    if (!this._request) {
      this._request = requestAnimationFrame(this.resizePaper)
    }
  }

  resizePaper = () => {
    this.forceUpdate()
    this._request = null
  }

  componentDidMount() {
    this.setState({ mounted: true })
    window.addEventListener('resize', this.resizeWindow)
  }

  componentWillUnmount() {
    if (this._request) {
      cancelAnimationFrame(this._request)
      this._request = null
    }
    window.removeEventListener('resize', this.resizeWindow)
  }

  render() {
    const { mounted } = this.state
    const box = this._box && this._box.getBoundingClientRect()
    return (
      <div className="App" ref={ref => this._box = ref}>
        {mounted &&
          <Paper
            image={MR_BUBBLES}
            initialData={INITIAL_DATA}
            width={box.width}
            height={box.height-56}
          />}
      </div>
    )
  }

}

export default App
